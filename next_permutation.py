class Solution:
    # @param A : list of integers
    # @return a list of integers
    def sm(self,a,b):
    	k=0
    	for i in a:
    		k=k*10+i
    	for i in b:
    		k=k*10+i
    	return k
    def nextPermutation(self,A):
    	lst = len(A)

    	for i in range(len(A)-2,-1,-1):
    		if(A[i+1]>A[i]):
    			lst = i
    			break
    	pvt = len(A)-1
    	for ii in range(len(A)-1,lst-1,-1):
    		if A[ii]<A[lst]:
    			pvt = i
    		else:
    			break
    	k_tmp = A[lst];A[lst]= A[pvt];A[pvt] = k_tmp;
    	A= A[:lst+1]+A[lst+1:][::-1]
    	return A
    	


    def nextPermutations(self,A):
    	n=len(A)
    	fst = self.sm(A,[])
    	for i in range(1,len(A)+1):
    		x=A[n-i:]
    		x=[str(ii) for ii in x]
    		x.sort(reverse=True)
    		x=[int(ii) for ii in x]
    		if fst<self.sm( A[:n-i],x):
    			return A[:n-i]+x
    	return A[::-1]



aa=[20, 50, 113]
#aa=[1, 2, 3, 6, 5, 4]
aa= [ 444, 994, 508, 72, 125, 299, 181, 238, 354, 223, 691, 249, 838, 890, 758, 675, 424, 199, 201, 788, 609, 582, 979, 259, 901, 371, 766, 759, 983, 728, 220, 16, 158, 822, 515, 488, 846, 321, 908, 469, 84, 460, 961, 285, 417, 142, 952, 626, 916, 247, 116, 975, 202, 734, 128, 312, 499, 274, 213, 208, 472, 265, 315, 335, 205, 784, 708, 681, 160, 448, 365, 165, 190, 693, 606, 226, 351, 241, 526, 311, 164, 98, 422, 363, 103, 747, 507, 669, 153, 856, 701, 319, 695, 52 ]


print Solution().nextPermutation(aa)






'''

[444, 994, 508, 72, 125, 299, 181, 238, 354, 223, 691, 249, 838, 890, 758, 675, 424, 199, 201, 788, 609, 582, 979, 259, 901, 371, 766, 759, 983, 728, 220, 16, 158, 822, 515, 488, 846, 321, 908, 469, 84, 460, 961, 285, 417, 142, 952, 626, 916, 247, 116, 975, 202, 734, 128, 312, 499, 274, 213, 208, 472, 265, 315, 335, 205, 784, 708, 681, 160, 448, 365, 165, 190, 693, 606, 226, 351, 241, 526, 311, 164, 98, 422, 363, 103, 747, 507, 669, 153, 856, 701, 695, 319, 52]



 444 994 508 72 125 299 181 238 354 223 691 249 838 890 758 675 424 199 201 788 609 582 979 259 901 371 766 759 983 728 220 16 158 822 515 488 846 321 908 469 84 460 961 285 417 142 952 626 916 247 116 975 202 734 128 312 499 274 213 208 472 265 315 335 205 784 708 681 160 448 365 165 190 693 606 226 351 241 526 311 164 98 422 363 103 747 507 669 153 856 701 695 52 319 





 A : [ 735, 913, 378, 121, 632, 868, 504, 40, 455, 101, 896, 748, 448, 179, 371, 650, 462, 256, 474, 904, 550, 812, 587, 767, 967, 897, 79, 97, 67, 915, 307, 202, 470, 328, 699, 619, 707, 349, 891, 664, 561, 609, 303, 827, 949, 172, 217, 585, 608, 146, 91, 776, 344, 974, 252, 906, 240 ]


  735 913 378 121 632 868 504 40 455 101 896 748 448 179 371 650 462 256 474 904 550 812 587 767 967 897 79 97 67 915 307 202 470 328 699 619 707 349 891 664 561 609 303 827 949 172 217 585 608 146 91 776 344 974 906 252 240 



   735 913 378 121 632 868 504 40 455 101 896 748 448 179 371 650 462 256 474 904 550 812 587 767 967 897 79 97 67 915 307 202 470 328 699 619 707 349 891 664 561 609 303 827 949 172 217 585 608 146 91 776 344 974 906 240 252 



'''